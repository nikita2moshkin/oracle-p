<!DOCTYPE html>  
<html lang="ru">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">  
    <title>ORACLE.P | KINDLE EDITION V2</title>  
    <style>  
        body, html {  
            margin: 0; padding: 0; width: 100%; height: 100%;  
            background-color: #fff; color: #000; 
            overflow: hidden; text-transform: uppercase;  
            -webkit-user-select: none;  
        }  

        body.dark-mode { background-color: #000; color: #fff; }
        body.dark-mode .detail { border-color: #fff; }
        body.dark-mode .line { background-color: #fff; }
        body.dark-mode .image-container img { filter: invert(1) grayscale(1); }
        
        /* Glitch States */
        body.white-out { background-color: #fff !important; }
        body.white-out * { display: none !important; }
        body.tsunami-mode { background-color: #000 !important; color: #fff !important; }
        body.tsunami-mode .tsunami-text { display: block; }

        #canvas { position: relative; width: 100vw; height: 100vh; }  
        .element { position: absolute; line-height: 0.85; word-wrap: break-word; }  

        /* Типографика + Новая системная */  
        .f-sans { font-family: "HelveticaNeue-CondensedBlack", "Helvetica Neue", Helvetica, Arial, sans-serif; font-weight: 900; letter-spacing: -2px; }  
        .f-serif { font-family: "Georgia", serif; font-style: italic; font-weight: 400; }  
        .f-mono { font-family: "Courier New", monospace; font-weight: 400; letter-spacing: -1px; }  
        .f-system { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; font-weight: 700; letter-spacing: 0px; }

        /* P: Меньше размер, плотное прилегание (-2%) */  
        .giant-p { 
            font-size: 50vh; 
            font-weight: 900; 
            z-index: 10; 
            opacity: 1; 
            position: absolute;
            line-height: 0.8;
            margin: 0;
            padding: 0;
        }  
        
        .giant-p.top-left { top: -2%; left: -2%; }
        .giant-p.top-right { top: -2%; right: -2%; }
        .giant-p.bottom-left { bottom: -2%; left: -2%; }
        .giant-p.bottom-right { bottom: -2%; right: -2%; }

        /* Ghosting Layer */
        .ghost-layer { opacity: 0.08 !important; z-index: 0 !important; filter: grayscale(1) blur(1px); pointer-events: none; }

        .hero { font-size: 11vw; font-weight: 900; width: 90%; z-index: 100; letter-spacing: -2px; }  
        .hero span { display: inline-block; margin-right: 5px; }  
          
        .sub-text { font-size: 4vw; font-weight: 400; z-index: 20; width: 80%; line-height: 1.1; }  
        .detail { font-size: 3vw; z-index: 50; font-weight: 700; border: 2px solid #000; padding: 2px 5px; white-space: nowrap; }  

        .line { position: absolute; background-color: #000; z-index: 5; }
        .image-container { position: absolute; z-index: 10; max-width: 45%; opacity: 0.9; mix-blend-mode: multiply; }
        body.dark-mode .image-container { mix-blend-mode: difference; }
        .image-container img { width: 100%; height: auto; display: block; filter: grayscale(1) contrast(1.2); }

        /* New Glitch Style */
        .tsunami-text {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            font-family: "Courier New", monospace; font-size: 12px; line-height: 1;
            overflow: hidden; z-index: 9999; opacity: 0.8; word-break: break-all;
        }

    </style>  
</head>  
<body onclick="handleInteraction()">  

    <div id="canvas"></div>  
    <div class="tsunami-text" id="tsunamiBox"></div>

    <script>  
        // Разделение контента для механики Gaslighting
        const slogansGaslighting = [
            "Don't Think Different", "Think! Think?", "Believe in Worst", "Enjoy the Emptiness",
            "God is a beta tester", "War is Peace. Debt is Wealth.", "100% Organic Illusion",
            "Update your morality", "Your soul is cooked", "ERROR: REALITY NOT FOUND",
            "Trust The Algorithm", "It's All In Your Head", "We Never Said That"
        ];
        const slogansGeneral = [
            "Just F*ck It", "BECAUSE YOU'RE A PRODUCT", "Want a break from the ads?",
            "Keep Scrolling", "Save 50% on your karma", "Subscribe to Reality+",
            "Limited time offer: Reincarnation", "J-SUS X", "Satan: Unsubscribe at any time",
            "iPhone!!! (New One)", "Sold my data for a donut.", "Who still remembers Skype?",
            "1000 Aura / One Million Likes", "Dinosaurs died from cringe", "We are cooked...",
            "The world is over! (except Bali)", "WAKE UP, TATARSKY", "Don't Live. Watch.",
            "HTML IS NOT REAL / CSS IS PROPAGANDA", "404 B**CH!", "Control + Z: Undo your birth",
            "Netflix and Netflix", "Admin_Root_Ishtar: BRUH"
        ];

        const meta = ["MONEY?", "WHY?", "OBEY.", "CANCELLED", "SOLD OUT", "...", "HEX: 0x53 0x4F 0x55 0x4C", "ADOBE IS TOO EXPENSIVE", "WAKE UP", "USER_NOT_FOUND", "DATA_MINING", "NULL", "VOID", "PURE_ART", "SYSTEM_FAILURE"];  
        // Добавлен f-system
        const fontClasses = ["f-sans", "f-serif", "f-mono", "f-system"];  
        const pCorners = ['top-left', 'top-right', 'bottom-left', 'bottom-right'];
        // Используем локальный placeholder для надежности, замените на свой URL
        const imageUrl = 'https://domf5oio6qrcr.cloudfront.net/medialibrary/7349/7ae782c0-24f9-4128-97a9-8b64432bce76.jpg';

        let clickCount = 0;
        const CLICK_WIPE_THRESHOLD = 25;

        function handleInteraction() {
            clickCount++;
            const rnd = Math.random();

            // Glitch System
            if (rnd < 0.05) {
                // Whiteout (Existing)
                triggerGlitch('white-out', 800);
            } else if (rnd < 0.08) {
                // Tsunami (New Beautiful Glitch)
                tsunamiGlitch();
            } else if (rnd < 0.13) { 
                // Visual Chaos (Existing)
                visualChaos();
            } else {
                spawn();
            }
        }

        function triggerGlitch(className, duration) {
            document.body.classList.add(className);
            setTimeout(() => { 
                document.body.classList.remove(className); 
                spawn(); 
            }, duration);
        }

        function tsunamiGlitch() {
            const box = document.getElementById('tsunamiBox');
            let content = '';
            for(let i=0; i<2000; i++) {
                content += meta[Math.floor(Math.random()*meta.length)] + " ";
            }
            box.innerText = content;
            triggerGlitch('tsunami-mode', 1200);
        }

        function visualChaos() {
            ghostCurrentLayer();
            for (let i = 0; i < 40; i++) {
                createEl('chaos-item ' + fontClasses[Math.floor(Math.random()*4)], slogansGeneral[Math.floor(Math.random()*slogansGeneral.length)], {
                    top: Math.random() * 100 + '%', left: Math.random() * 100 + '%',
                    fontSize: (Math.random() * 15 + 2) + 'vw',
                    transform: `rotate(${Math.random() * 360}deg)`, opacity: Math.random() * 0.5 + 0.2, zIndex: 999
                });
            }
        }

        function ghostCurrentLayer() {
            const canvas = document.getElementById('canvas');
            // Превращаем текущие активные элементы в призраков
            Array.from(canvas.children).forEach(el => {
                if (!el.classList.contains('ghost-layer')) {
                    el.classList.add('ghost-layer');
                }
            });
            
            // Очистка каждые N кликов
            if (clickCount % CLICK_WIPE_THRESHOLD === 0) {
                 canvas.innerHTML = '';
            }
        }

        function spawn() {  
            // 1. Ghosting Implementation
            ghostCurrentLayer();

            // 2. Slogan Selection & Gaslighting Inversion Logic
            let slogan;
            let isGaslighting = false;
            if (Math.random() > 0.6) {
                slogan = slogansGaslighting[Math.floor(Math.random() * slogansGaslighting.length)];
                isGaslighting = true;
            } else {
                slogan = slogansGeneral[Math.floor(Math.random() * slogansGeneral.length)];
            }

            // Inversion Chance calculation
            const inversionChance = isGaslighting ? 0.35 : 0.05;
            document.body.classList.toggle('dark-mode', Math.random() < inversionChance);

            // 3. P Generation (Reduced size, tight fit)
            const pClass = pCorners[Math.floor(Math.random() * pCorners.length)];
            createEl('giant-p ' + pClass + ' f-sans', "P", {});

            // 4. Lines
            const lineCount = Math.floor(Math.random() * 3);
            for (let i = 0; i < lineCount; i++) createLine(Math.random() > 0.5);

            // 5. Image
            if (Math.random() < 0.3) createImage(imageUrl);

            // 6. Hero Slogan (with new font mix)
            const hero = createEl('hero f-sans', "", { left: '5%', top: (20 + Math.random() * 40) + '%' });  
            slogan.split(' ').forEach(word => {  
                const span = document.createElement('span');  
                span.innerText = word;  
                if (Math.random() > 0.75) span.className = fontClasses[Math.floor(Math.random() * fontClasses.length)];  
                hero.appendChild(span);  
            });  

            // 7. Meta & Details
            createEl('sub-text ' + fontClasses[Math.floor(Math.random()*4)], meta[Math.floor(Math.random()*meta.length)], { left: '5%', bottom: '8%' });  
            const detailCount = 1 + Math.floor(Math.random() * 2);
            for(let i=0; i<detailCount; i++) {  
                createEl('detail ' + fontClasses[Math.floor(Math.random()*4)], meta[Math.floor(Math.random()*meta.length)], {  
                    right: '5%', top: (Math.random() * 70 + 15) + '%'  
                });  
            }  
        }  

        function createEl(cls, txt, styles) {  
            const div = document.createElement('div');  
            div.className = 'element ' + cls;  
            if (txt) div.innerText = txt;  
            // Исключаем P и системный шрифт из поворотов
            if (!cls.includes('giant-p') && !cls.includes('f-system') && Math.random() > 0.94) {  
                div.style.transform = "rotate(90deg)"; div.style.transformOrigin = "left top";  
            }  
            Object.assign(div.style, styles);  
            document.getElementById('canvas').appendChild(div);  
            return div;  
        }  

        function createLine(isVertical) {
            const line = document.createElement('div');
            line.className = 'line';
            if (isVertical) {
                line.style.width = (Math.random() * 2 + 1) +'px'; line.style.height = '100vh';
                line.style.left = (Math.random() * 90 + 5) + '%'; line.style.top = '0';
            } else {
                line.style.width = '100vw'; line.style.height = (Math.random() * 2 + 1) +'px';
                line.style.top = (Math.random() * 90 + 5) + '%'; line.style.left = '0';
            }
            document.getElementById('canvas').appendChild(line);
        }

        function createImage(src) {
            const container = document.createElement('div');
            container.className = 'image-container';
            container.style.top = (Math.random() * 40 + 10) + '%';
            container.style.left = (Math.random() * 30 + 5) + '%';
            const img = document.createElement('img');
            img.src = src;
            container.appendChild(img);
            document.getElementById('canvas').appendChild(container);
        }

        window.onload = spawn;  
    </script>  
</body>  
</html>
