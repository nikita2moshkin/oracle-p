<!DOCTYPE html>  
<html lang="ru">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">  
    <title>ORACLE.P | ECAL FINAL</title>  
    <style>  
        body, html {  
            margin: 0; padding: 0; width: 100%; height: 100%;  
            background-color: #000; color: #fff; 
            overflow: hidden; text-transform: uppercase;  
            -webkit-user-select: none;  
            font-family: "Helvetica Neue", Arial, sans-serif;
        }  

        body.white-mode { background-color: #fff; color: #000; }
        body.white-mode .line { background-color: #000; }
        
        #canvas { position: relative; width: 100vw; height: 100vh; overflow: hidden; }  
        .element { position: absolute; word-wrap: break-word; line-height: 0.75; opacity: 0; transition: opacity 0.3s; color: currentColor; }  
        .visible { opacity: 1 !important; }

        /* ШРИФТЫ */  
        .f-heavy { font-family: "Impact", sans-serif; font-weight: 900; letter-spacing: -2px; } 
        .f-light { font-family: "Helvetica Neue", sans-serif; font-weight: 200; letter-spacing: 2px; } 
        .f-serif { font-family: "Georgia", serif; font-style: italic; text-transform: none; } 
        .f-mono { font-family: "Courier New", monospace; font-weight: 400; } 
        .f-wide { font-family: "Arial Black", sans-serif; transform: scaleX(1.8); transform-origin: left; letter-spacing: -1px; }

        /* Статичная P: Фон, призрачный цвет */  
        .giant-p { 
            font-size: 60vh; font-weight: 900; z-index: 0; 
            position: absolute; top: 2%; left: 2%; 
            opacity: 0.2; pointer-events: none;
            color: currentColor; /* Исправлено: цвет меняется с темой */
        }  
        
        .line { position: absolute; background-color: currentColor; opacity: 0.3; z-index: 1; }
        .image-container { position: absolute; z-index: 5; filter: invert(1) grayscale(1); mix-blend-mode: difference; }
        .image-container img { width: 100%; height: auto; display: block; image-rendering: pixelated; }

        .hero { z-index: 100; line-height: 0.7; }
        .hero span { display: inline-block; margin-right: 0.2em; } 

        .meta-footer { position: absolute; bottom: 4%; right: 4%; z-index: 110; font-size: 2.5vw; text-align: right; opacity: 0.6; }

        /* ЭФФЕКТ МЕСИВА */
        #glitch-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: inherit; z-index: 9999; display: none; overflow: hidden;
        }
        .mess { text-shadow: 10px 10px 0px rgba(128,128,128,0.5), -10px -5px 0px rgba(64,64,64,0.5); }
    </style>  
</head>  
<body onclick="handleInteraction()">  

    <div id="glitch-overlay"></div>
    <div id="canvas">
        <div class="element giant-p f-heavy visible">P</div>
    </div>  

    <script>  
        const slogans = ["PRAY TO THE ROUTER", "SKIBIDI EXISTENTIALISM", "DOSTOEVSKY ON TIKTOK", "SHREK’S PODCAST ABOUT DMT", "TYPOGRAPHY IS PROPAGANDA.", "HELVETICA IS A VIRUS.", "ANCIENT GREEK SHITPOSTING", "WATER IS JUST SOFT ICE.", "JUST F*CK IT", "WAKE UP, TATARSKY"];  
        const subtitles = ["Stop thinking about that. It's cringe.", "Your ISP is judging your taste.", "TURN AROUND. SLOWLY.", "APOLOGIZE TO THE ALGORITHM.", "LICK THE DISPLAY. IT’S SALTY.", "Say YES/NO to drugs"];
        const fragments = ["E-ink bleed", "digital dust", "0.0001% soul", "buffer: full", "system failure", "ink_ghosting: detected"];
        const meta = ["{status: waiting}", "LMAO", "RESET", "ABORT", "VOID", "BRUH", "0x534F554C", "42", "100%"];  
        
        const imageLibrary = [
            'https://24smi.org/public/media/290x360/celebrity/2016/04/29/1461942758-vanga.jpg',
            'https://images-cdn.ubuy.co.in/63a07047a023683963549705-laminated-pop-art-che-guevara-portrait.jpg',
            'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a6/Anonymous_emblem.svg/1280px-Anonymous_emblem.svg.png',
            'https://png.pngtree.com/png-vector/20231017/ourmid/pngtree-fresh-apple-fruit-red-png-image_10203073.png'
        ];

        let isLocked = false;
        const fontClasses = ["f-heavy", "f-light", "f-serif", "f-mono", "f-wide"];
        const delay = ms => new Promise(res => setTimeout(res, ms));

        function handleInteraction() {
            if (isLocked) return;
            if (Math.random() < 0.04) triggerHardGlitch();
            else sequentialSpawn();
        }

        async function triggerHardGlitch() {
            isLocked = true;
            const overlay = document.getElementById('glitch-overlay');
            overlay.style.display = 'block';
            overlay.innerHTML = '';
            overlay.style.backgroundColor = document.body.style.backgroundColor;

            for (let i = 0; i < 60; i++) {
                const char = document.createElement('div');
                char.className = 'element visible mess ' + fontClasses[Math.floor(Math.random()*fontClasses.length)];
                char.style.cssText = `left:${Math.random()*80}%; top:${Math.random()*90}%; font-size:${Math.random()*30}vw; opacity:${Math.random()};`;
                char.innerText = slogans[Math.floor(Math.random()*slogans.length)];
                overlay.appendChild(char);
                if(i % 5 === 0) await delay(20);
            }
            await delay(3000);
            overlay.style.display = 'none';
            isLocked = false;
            sequentialSpawn();
        }

        async function sequentialSpawn() {  
            const canvas = document.getElementById('canvas'); 
            const p = canvas.querySelector('.giant-p');
            canvas.innerHTML = ''; canvas.appendChild(p);
            
            const isSwissGrid = Math.random() < 0.3;
            document.body.className = (Math.random() < 0.15) ? 'white-mode' : '';

            // 1. ЛИНИИ
            const lineCount = Math.random() < 0.2 ? 0 : (isSwissGrid ? 14 : Math.floor(Math.random()*6));
            for (let i = 0; i < lineCount; i++) {
                const line = createLine(isSwissGrid);
                line.classList.add('visible');
                if (i % 2 === 0) await delay(30);
            }

            // 2. КАРТИНКИ (Шанс 25%)
            if (Math.random() < 0.25) {
                const img = createImage();
                await delay(100);
                img.classList.add('visible');
            }

            // 3. ТЕКСТ (Масштабируемый)
            const elementsCount = Math.floor(Math.random() * 3) + 1;
            for(let i = 0; i < elementsCount; i++) {
                await spawnText(isSwissGrid, elementsCount > 2);
                await delay(150);
            }

            // 4. ФУТЕР
            const footer = createEl('meta-footer f-mono', meta[Math.floor(Math.random()*meta.length)], {});
            await delay(50);
            footer.classList.add('visible');
        }  

        async function spawnText(isGrid, isCrowded) {
            const isHero = !isCrowded || Math.random() > 0.5;
            const txt = slogans[Math.floor(Math.random()*slogans.length)];
            const isVertical = Math.random() < 0.2;
            const isRotated = Math.random() < 0.15;
            
            const block = createEl(isHero ? 'hero' : 'sub-hero', '', {
                left: isGrid ? (Math.floor(Math.random()*6)*15 + 5)+'%' : Math.random()*50+'%',
                top: isGrid ? (Math.floor(Math.random()*8)*10 + 10)+'%' : Math.random()*70+'%',
                fontSize: isCrowded ? (Math.random()*5 + 6)+'vw' : (Math.random()*10 + 15)+'vw',
                transform: isVertical ? 'rotate(90deg)' : (isRotated ? `rotate(${Math.random()*8-4}deg)` : 'none'),
                transformOrigin: 'left top'
            });

            txt.split(' ').forEach(word => {
                const span = document.createElement('span');
                span.innerText = word;
                span.className = fontClasses[Math.floor(Math.random()*fontClasses.length)];
                block.appendChild(span);
            });
            block.classList.add('visible');
        }

        function createLine(isGrid) {
            const line = document.createElement('div');
            line.className = 'line element';
            const isVert = Math.random() > 0.5;
            const thick = (Math.random() * 5 + 1) + 'px';
            if (isVert) {
                line.style.width = thick; line.style.height = '100vh';
                line.style.left = isGrid ? (Math.floor(Math.random()*12)*(100/12)) + '%' : Math.random()*100 + '%';
            } else {
                line.style.width = '100vw'; line.style.height = thick;
                line.style.top = isGrid ? (Math.floor(Math.random()*16)*(100/16)) + '%' : Math.random()*100 + '%';
            }
            document.getElementById('canvas').appendChild(line);
            return line;
        }

        function createImage() {
            const container = document.createElement('div');
            container.className = 'image-container element';
            const isBig = Math.random() > 0.4;
            container.style.width = isBig ? (Math.random()*40 + 50)+'%' : (Math.random()*20 + 10)+'%';
            container.style.left = Math.random()*50+'%';
            container.style.top = Math.random()*50+'%';
            if (Math.random() < 0.2) container.style.transform = `rotate(${Math.random()*20-10}deg)`;
            
            const img = document.createElement('img');
            img.src = imageLibrary[Math.floor(Math.random()*imageLibrary.length)];
            container.appendChild(img);
            document.getElementById('canvas').appendChild(container);
            return container;
        }

        function createEl(cls, txt, styles) {  
            const div = document.createElement('div');  
            div.className = 'element ' + cls;  
            if (txt) div.innerText = txt;  
            Object.assign(div.style, styles);  
            document.getElementById('canvas').appendChild(div);  
            return div;  
        }  

        window.onload = sequentialSpawn;  
    </script>  
</body>  
</html>
